(()=>{"use strict";var t={913:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.gameConfig=void 0;const n=i(322),s=i(762),r=innerWidth,o=innerHeight,a=new s.StateStack,h=new n.Frame(r,o);h.setRenderingContext("2d");const c=h.getRenderingContext;e.gameConfig={stateStack:a,frame:h,ctx:c,width:r,height:o,id:0,entities:[]}},950:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Asteroid=void 0;const n=i(599),s=i(913),r=i(262);e.Asteroid=class{constructor(){const{width:t,height:e}=s.gameConfig;this.x=(0,n.rand)(0,t),this.y=(0,n.rand)(0,e),this.w=(0,n.randEven)(8,48),this.h=this.w,this.speed=(0,n.rand)(20,300),this.angle=(0,n.degreeToRadian)((0,n.rand)(0,360)),this.active=!0}resetLocation(){this.angle=(0,n.degreeToRadian)((0,n.rand)(0,360))}move(){const{width:t,height:e}=s.gameConfig;this.x<0?(this.x=t-this.w,this.resetLocation()):this.x>t&&(this.x=0,this.resetLocation()),this.y<0?(this.y=e-this.w,this.resetLocation()):this.y>e&&(this.y=0,this.resetLocation()),this.x+=this.speed*Math.cos(this.angle)*r.delta,this.y+=this.speed*Math.sin(this.angle)*r.delta}update(){this.move()}render(){const t=s.gameConfig.ctx;t.save(),t.translate(this.x+this.w/2,this.y+this.h/2),t.rotate(this.angle),t.strokeStyle="#ffffff",t.strokeRect(-this.w/2,-this.h/2,this.w,this.h),t.restore()}}},226:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Bullet=void 0;const n=i(913),s=i(262);e.Bullet=class{constructor(t,e,i,n){this.owner="PLAYER",this.x=0,this.y=0,this.w=4,this.h=4,this.speed=300,this.angle=0,this.active=!0,this.owner=t,this.x=e,this.y=i,this.angle=n}killAfterSecond(){setTimeout((()=>{this.active=!1}),1e3)}handleScreenBorders(){const{width:t,height:e}=n.gameConfig;this.x<0?(this.x=t,this.killAfterSecond()):this.x>t&&(this.x=0,this.killAfterSecond()),this.y<0?(this.y=e,this.killAfterSecond()):this.y>e&&(this.y=0,this.killAfterSecond())}update(){this.handleScreenBorders(),this.x+=this.speed*Math.cos(this.angle)*s.delta,this.y+=this.speed*Math.sin(this.angle)*s.delta}render(){const t=n.gameConfig.ctx;t.save(),t.translate(this.x+this.w/2,this.y+this.h/2),t.rotate(this.angle),t.fillStyle="#ffffff",t.fillRect(-this.w/2,-this.h/2,this.w,this.h),t.restore()}}},661:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.hero=void 0;const n=i(29),s=i(262),r=i(913),o=i(226);e.hero=new class{constructor(){this.x=0,this.y=0,this.w=32,this.h=32,this.speed=150,this.angle=0,this.active=!0,this.lastHit=Date.now(),this.lives=3,this.score=0,this.weaponCooldown=0,this.weaponCooldownDecrement=2.5}saveToLocalStorage(){const t="asteroids/player";if(!localStorage.getItem(t)){const e={highScore:this.score};localStorage.setItem(t,JSON.stringify(e))}const e=JSON.parse(localStorage.getItem(t));e.highScore=this.score>e.highScore?this.score:e.highScore,localStorage.setItem(t,JSON.stringify(e))}loadFromLocalStorage(){}shoot(){this.weaponCooldown<=0&&(r.gameConfig.entities.push(new o.Bullet("PLAYER",this.x+this.w/2,this.y+this.h/2,this.angle)),this.weaponCooldown=100)}keyHandler(){(0,n.isDown)("A")?this.angle-=2.5*s.delta:(0,n.isDown)("D")&&(this.angle+=2.5*s.delta),(0,n.isDown)("W")&&(this.x+=this.speed*Math.cos(this.angle)*s.delta,this.y+=this.speed*Math.sin(this.angle)*s.delta),(0,n.isDown)("SPACE")&&this.shoot()}hit(){Date.now()>this.lastHit+5e3&&(this.lives>1?this.lives-=1:this.saveToLocalStorage())}update(){this.keyHandler(),this.weaponCooldown>0&&(this.weaponCooldown-=this.weaponCooldownDecrement)}render(){const t=r.gameConfig.ctx;t.save(),t.translate(this.x+this.w/2,this.y+this.h/2),t.rotate(this.angle),t.fillStyle="#ffffff";let e=-this.w/2,i=-this.h/2;t.fillRect(e,i,this.w,this.h),t.restore()}}},919:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Star=void 0;const n=i(913),s=i(599);e.Star=class{constructor(){const{width:t,height:e}=n.gameConfig;this.x=(0,s.rand)(0,t),this.y=(0,s.rand)(0,e),this.w=2,this.h=this.w,this.speed=3,this.angle=(0,s.degreeToRadian)((0,s.rand)(0,360)),this.active=!0}render(){const t=n.gameConfig.ctx;t.save(),t.translate(this.x+this.w/2,this.y+this.h/2),t.rotate(this.angle),t.fillStyle="#ffffff",t.fillRect(-this.w/2,-this.h/2,this.w,this.h),t.restore()}update(){}}},769:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.asteroids=void 0;const n=i(913),s=i(262);e.asteroids=new class{constructor(){this.loop=this.loop.bind(this)}render(){var t;null===(t=n.gameConfig.stateStack.peek())||void 0===t||t.render()}update(){var t;null===(t=n.gameConfig.stateStack.peek())||void 0===t||t.update()}loop(){s.Perf.beforeCycle(),this.update(),this.render(),n.gameConfig.id=window.requestAnimationFrame(this.loop),s.Perf.afterCycle()}onStart(){n.gameConfig.frame.create(document.body),this.loop()}init(t){if(t&&n.gameConfig.stateStack.push(t),0===n.gameConfig.stateStack.size())throw new Error("Cannot initialize game without any state");this.onStart()}}},988:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.dev=void 0;const n=i(950),s=i(913),r=i(661),o=i(29),a=i(919);e.dev=new class{onEnter(){(0,o.initInput)();const{entities:t}=s.gameConfig;for(let e=0;e<70;e++)t.push(new a.Star);for(let e=0;e<10;e++)t.push(new n.Asteroid);t.push(r.hero)}onExit(){}onPause(){}onResume(){}render(){let{width:t,height:e,entities:i}=s.gameConfig;s.gameConfig.ctx.clearRect(0,0,t,e),i&&0!==i.length&&(i=i.filter((t=>!0===t.active)),i.forEach((t=>t.render())))}update(){const{entities:t}=s.gameConfig;t&&0!==t.length&&t.forEach((t=>t.update()))}}},322:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Frame=void 0;class i{constructor(t,e,i){this.width=null!=t?t:innerWidth,this.height=null!=e?e:innerHeight,this.backgroundColor=null!=i?i:"#000000",this.id=Date.now(),this.canvas=document.createElement("canvas"),this.destination=document.body,this.context=null,this.canvas.id=String(this.id),this.canvas.width=this.width,this.canvas.height=this.height,this.canvas.style.backgroundColor=this.backgroundColor,this.canvas.innerHTML='\n            <h2>Unsuported browser</h2>\n            <p>\n                Sorry, but your current browser won\'t do anymore. \n                Either you upgrade your browser or just leave.\n            </p>\n            <a href="https://www.mozilla.org/en-US/firefox/new/">Browser upgrade</a>\n        '}create(t){t?(this.destination=t,this.destination.appendChild(this.canvas)):this.destination.appendChild(this.canvas)}remove(){this.destination.removeChild(this.canvas)}resize(t,e){this.width=t,this.height=e,this.canvas.width=t,this.canvas.height=e}static createInstance(t){let e=new i(t.width,t.height,t.style.backgroundColor);return e.setDestination=t.parentElement,e}get getWidth(){return this.width}get getHeight(){return this.height}get getBackgroundColor(){return this.backgroundColor}get getId(){return this.id}get getCanvas(){return this.canvas}get getDestination(){return this.destination}get getRenderingContext(){return this.context}set setWidth(t){this.width=t,this.canvas.width=t}set setHeight(t){this.height=t,this.canvas.height=t}set setBackgroundColor(t){this.backgroundColor=t,this.canvas.style.backgroundColor=t}set setId(t){this.id=t,this.canvas.id=String(t)}set setCanvas(t){this.canvas=t}set setDestination(t){this.destination=t}setRenderingContext(t,e){this.context=this.canvas.getContext(t,e)}}e.Frame=i},29:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.initInput=e.isDown=void 0;const i={};function n(t,e){const n=t.keyCode;let s;switch(n){case 27:s="ESC";break;case 32:s="SPACE";break;case 13:s="ENTER";break;default:s=String.fromCharCode(n)}i[s]=e}e.isDown=function(t){return i[t]},e.initInput=function(){window.addEventListener("keydown",(t=>n(t,!0))),window.addEventListener("keyup",(t=>n(t,!1)))}},599:function(t,e,i){var n=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i);var s=Object.getOwnPropertyDescriptor(e,i);s&&!("get"in s?!e.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,n,s)}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),s=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),r=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&n(e,t,i);return s(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.Maths=e.getUnitVector=e.deepFloatCmp=e.getVectorLength=e.getDividedVector=e.getScaledVector=e.getNegateVector=e.substrVectorArray=e.substrVectors=e.sumVectorArray=e.sumVectors=e.limitValue=e.degreeToRadian=e.isNumberBetween=e.randBool=e.randElement=e.randInt=e.randEven=e.rand=e.Circle=e.LineSegment=e.Line=e.OrientedRect=e.Rect=e.Vec2=void 0;class o{constructor(t,e){this.x=null!=t?t:0,this.y=null!=e?e:0}}e.Vec2=o;class a{constructor(t,e,i,n){this.x=null!=t?t:0,this.y=null!=e?e:0,this.w=null!=i?i:10,this.h=null!=n?n:10}}function h(t,e){return t+Math.random()*(e-t)}function c(t,e){return Math.floor(h(t,e))}function l(t){return t[c(0,t.length)]}function d(t,e){return new o(t.x/e,t.y/e)}function u(t){return Math.sqrt(t.x*t.x+t.y*t.y)}e.Rect=a,e.OrientedRect=class extends a{constructor(t=0,e=0,i=4,n=4,s=0){super(t,e,i,n),this.angle=s}},e.Line=class{constructor(t,e){this.base=null!=t?t:new o,this.direction=null!=e?e:new o}},e.LineSegment=class{constructor(t,e){this.a=null!=t?t:new o,this.b=null!=e?e:new o}},e.Circle=class{constructor(t,e){this.position=null!=t?t:new o,this.radius=null!=e?e:0}},e.rand=h,e.randEven=function(t,e){let i=[];for(let n=t;n<e;n++)n%2==0&&i.push(n);return l(i)},e.randInt=c,e.randElement=l,e.randBool=function(){return l([!0,!1])},e.isNumberBetween=function(t,e,i){return t>=e&&t<=i},e.degreeToRadian=function(t){return t*Math.PI/180},e.limitValue=function(t,e,i){return Math.max(e,Math.min(i,t))},e.sumVectors=function(t,e){return new o(t.x+e.x,t.y+e.y)},e.sumVectorArray=function(t){const e=t.length-1,i=new o;for(let n=0;n<e;n++)i.x+=t[n].x,i.y+=t[n].y;return i},e.substrVectors=function(t,e){return new o(t.x-e.x,t.y-e.y)},e.substrVectorArray=function(t){const e=t.length-1,i=new o;for(let n=0;n<e;n++)i.x-=t[n].x,i.y-=t[n].y;return i},e.getNegateVector=function(t){return new o(-Math.abs(t.x),-Math.abs(t.y))},e.getScaledVector=function(t,e){return new o(t.x*e,t.y*e)},e.getDividedVector=d,e.getVectorLength=u,e.deepFloatCmp=function(t,e){return Math.abs(t-e)<1/8192},e.getUnitVector=function(t){const e=u(t);return 0<e?d(t,e):t};const g=new o(0,0);Object.freeze(g),e.Maths=r(i(599))},262:function(t,e,i){var n=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i);var s=Object.getOwnPropertyDescriptor(e,i);s&&!("get"in s?!e.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,n,s)}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),s=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),r=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&n(e,t,i);return s(e,t),e};function o(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()}Object.defineProperty(e,"__esModule",{value:!0}),e.Perf=e.afterCycle=e.beforeCycle=e.delta=e.fps=void 0;let a=0,h=o();e.fps=0,e.delta=0,e.beforeCycle=function(){a=o(),e.delta=Math.min(1,(a-h)/1e3),e.fps=1/e.delta},e.afterCycle=function(){h=a},e.Perf=r(i(262))},762:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.StateStack=void 0,e.StateStack=class{constructor(t=1/0){this.capacity=t,this.storage=[]}push(t){if(this.size()===this.capacity)throw new Error("Stack reached maximum capacity");t.onEnter(),this.storage.push(t)}pop(){let t=this.storage.pop();return null==t||t.onExit(),t}peek(){return this.storage[this.size()-1]}size(){return this.storage.length}}}},e={};function i(n){var s=e[n];if(void 0!==s)return s.exports;var r=e[n]={exports:{}};return t[n].call(r.exports,r,r.exports,i),r.exports}(()=>{const t=i(769),e=i(988);window.addEventListener("load",(function(){try{t.asteroids.init(e.dev)}catch(t){console.error(t),alert(t)}}))})()})();